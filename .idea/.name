bpnn_with_main